<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>MAML</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://dzzzw.github.io/dzane/"/>
  <updated>2019-01-13T07:42:34.000Z</updated>
  <id>http://dzzzw.github.io/dzane/</id>
  
  <author>
    <name>zane</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>语法</title>
    <link href="http://dzzzw.github.io/dzane/syntax/"/>
    <id>http://dzzzw.github.io/dzane/syntax/</id>
    <published>2019-01-13T05:41:22.000Z</published>
    <updated>2019-01-13T07:42:34.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="壁纸元素"><a href="#壁纸元素" class="headerlink" title="壁纸元素"></a>壁纸元素</h2><a id="more"></a><p>Wallpaper元素引用系统设置的壁纸，除了不能指定图片源外其他和Image元素相同，可以有动画和其他属性控制。如果没有此元素则不显示壁纸。可以有多个。例子：</p><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Wallpaper</span>/&gt;</span></span><br></pre></td></tr></table></figure><p><br><br><br></p><h2 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h2><p>变量用Var开头  </p><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Var</span> <span class="attr">name</span>=<span class="string">""</span> <span class="attr">expression</span>=<span class="string">""</span> <span class="attr">type</span>=<span class="string">""</span> <span class="attr">const</span>=<span class="string">""</span> <span class="attr">threshold</span>=<span class="string">""</span> <span class="attr">persist</span>=<span class="string">""</span>/&gt;</span></span><br></pre></td></tr></table></figure><table><thead><tr><th>代码</th><th>值</th><th>解释</th></tr></thead><tbody><tr><td>name</td><td>自定义名称</td><td>变量名</td></tr><tr><td>expression</td><td>表达式</td><td>变量对应的表达式或常量 注意：如果定义字符串常量需要多一套单引号: expression=”‘my string’”</td></tr><tr><td>type</td><td>number/string</td><td>定义数值变量或字符串变量 默认：number</td></tr><tr><td>const</td><td>true/false</td><td>为true时变量会在初始化后不会重新计算，可以提高效率。如果变量值会在锁屏运行期间改变，const设为false 默认：false</td></tr><tr><td>persist</td><td>true/false</td><td>默认false，变量持久化。指定为true后，如果没有重新给定该变量其他的值，那么这个值会一直保存，无论解锁后重新锁定或者重新应用主题都不会还原</td></tr><tr><td>threshold</td><td>阈值</td><td>阈值触发，当变量值的变化超过设定的阈值时，可以触发一些命令。例如：</td></tr></tbody></table><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Var</span> <span class="attr">name</span>=<span class="string">"time3"</span> <span class="attr">expression</span>=<span class="string">"#minute%10"</span> <span class="attr">threshold</span>=<span class="string">"1"</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">Trigger</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">Command</span> <span class="attr">target</span>=<span class="string">"time3_anim.visibility"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">Command</span> <span class="attr">target</span>=<span class="string">"time3_anim.animation"</span> <span class="attr">value</span>=<span class="string">"play"</span>/&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">Command</span> <span class="attr">target</span>=<span class="string">"time3_anim_new.visibility"</span> <span class="attr">value</span>=<span class="string">"false"</span>/&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">Command</span> <span class="attr">target</span>=<span class="string">"time_3_anim_new.visiblity"</span> <span class="attr">value</span>=<span class="string">"true"</span> <span class="attr">delay</span>=<span class="string">"400"</span>/&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">Command</span> <span class="attr">target</span>=<span class="string">"time_3_anim_new.animation"</span> <span class="attr">value</span>=<span class="string">"play"</span> <span class="attr">delay</span>=<span class="string">"400"</span>/&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">Trigger</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Var</span>&gt;</span></span><br></pre></td></tr></table></figure><p>上述代码表示#time3的值每变化1，就会执行<trigger>里面的所有命令</trigger></p><p><br><br><br></p><h2 id="全局变量"><a href="#全局变量" class="headerlink" title="全局变量"></a>全局变量</h2><p><strong>解锁</strong> </p><table><thead><tr><th>变量</th><th>释义</th></tr></thead><tbody><tr><td>unlocker.move_x</td><td>解锁部件在x方向的偏移</td></tr><tr><td>unlocker.move_y</td><td>解锁部件在y方向的偏移</td></tr><tr><td>unlocker.move_dist</td><td>解锁部件移动的距离</td></tr><tr><td>unlocker.state</td><td>解锁部件的状态： 0 normal, 1 pressed, 2 reached</td></tr></tbody></table><p><strong>触摸</strong>  </p><table><thead><tr><th>变量</th><th>释义</th></tr></thead><tbody><tr><td>touch_x</td><td>当前触摸点的x坐标</td></tr><tr><td>touch_y</td><td>当前触摸点的y坐标</td></tr><tr><td>touch_begin_x</td><td>按下屏幕时的初始x坐标</td></tr><tr><td>touch_begin_y</td><td>按下屏幕时的初始y坐标</td></tr><tr><td>touch_begin_time</td><td>按下屏幕时的时间</td></tr></tbody></table><p><strong>时间</strong>  </p><table><thead><tr><th>变量</th><th>释义</th></tr></thead><tbody><tr><td>time</td><td>当前时间，long</td></tr><tr><td>time_sys</td><td>系统时间毫秒数</td></tr><tr><td>year</td><td>年份</td></tr><tr><td>month</td><td>月份（取值范围是0~11，0表示一月，1表示二月，以此类推）</td></tr><tr><td>date</td><td>日期</td></tr><tr><td>day_of_week</td><td>星期（1表示星期日，2表示星期一，等等）</td></tr><tr><td>hour24</td><td>24小时制</td></tr><tr><td>minute</td><td>分钟</td></tr><tr><td>second</td><td>秒</td></tr><tr><td>ampm</td><td>上下午 0:am 1:pm</td></tr><tr><td>time_format</td><td>0：12小时制 1：24小时制</td></tr></tbody></table><p><strong>农历</strong>  </p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">year_lunar          农历年份</span><br><span class="line">year_lunar1864    用来计算天干地支</span><br><span class="line">month_lunar         农历月份 从0开始计</span><br><span class="line">month_lunar_leap0/1 是否润月</span><br><span class="line">date_lunar          农历日期 从1开始计</span><br></pre></td></tr></table></figure><p><strong>充电与电量</strong>   </p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">battery_level当前电量，1~100</span><br><span class="line">battery_state0正常 1充电 2电量低 3已充满</span><br></pre></td></tr></table></figure><p><strong>screen:</strong>  </p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">screen_width        屏幕宽度</span><br><span class="line">screen_height       屏幕高度</span><br><span class="line">view_width          部件宽度(各插件中才使用,比如时钟)</span><br><span class="line">view_height         部件高度(各插件中才使用,比如时钟)</span><br><span class="line">raw_screen_width物理宽度（这个表示当前设备的屏幕分辨率，不受根节点screenWidth的影响）</span><br><span class="line">raw_screen_height物理高度</span><br></pre></td></tr></table></figure><p>image:</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">image.actual_w图片显示宽度</span><br><span class="line">image.actual_h</span><br><span class="line">image.bmp_width图片文件的宽度（不受裁切、缩放的影响，只根据src找到指定的图片，并检测该文件的宽度）</span><br><span class="line">image.bmp_height</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;壁纸元素&quot;&gt;&lt;a href=&quot;#壁纸元素&quot; class=&quot;headerlink&quot; title=&quot;壁纸元素&quot;&gt;&lt;/a&gt;壁纸元素&lt;/h2&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>待办事项接口</title>
    <link href="http://dzzzw.github.io/dzane/dbsx/"/>
    <id>http://dzzzw.github.io/dzane/dbsx/</id>
    <published>2019-01-10T16:34:14.000Z</published>
    <updated>2019-01-13T07:11:24.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="待办事项接口"><a href="#待办事项接口" class="headerlink" title="待办事项接口"></a>待办事项接口</h2><a id="more"></a><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">VariableBinders</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">ContentProviderBinder</span> <span class="attr">name</span>=<span class="string">"calendar"</span> <span class="attr">uri</span>=<span class="string">"content://com.android.calendar/events"</span> <span class="attr">columns</span>=<span class="string">"title,eventLocation,dtstart,dtend,allDay,lastDate"</span> <span class="attr">order</span>=<span class="string">"dtstart ASC"</span> <span class="attr">whereFormat</span>=<span class="string">"allDay=0 AND dtstart&gt;%d"</span> <span class="attr">whereParas</span>=<span class="string">"#time_sys"</span> <span class="attr">countName</span>=<span class="string">"hasEvents"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">Variable</span> <span class="attr">name</span>=<span class="string">"cal_title1"</span> <span class="attr">type</span>=<span class="string">"string"</span> <span class="attr">column</span>=<span class="string">"title"</span> <span class="attr">row</span>=<span class="string">"0"</span>/&gt;</span>标题</span><br><span class="line">  <span class="tag">&lt;<span class="name">Variable</span> <span class="attr">name</span>=<span class="string">"event_eventLocation1"</span> <span class="attr">type</span>=<span class="string">"string"</span> <span class="attr">column</span>=<span class="string">"eventLocation"</span> <span class="attr">row</span>=<span class="string">"0"</span>/&gt;</span>事件的位置</span><br><span class="line">  <span class="tag">&lt;<span class="name">Variable</span> <span class="attr">name</span>=<span class="string">"event_start1"</span> <span class="attr">type</span>=<span class="string">"long"</span> <span class="attr">column</span>=<span class="string">"dtstart"</span> <span class="attr">row</span>=<span class="string">"0"</span>/&gt;</span>开始</span><br><span class="line">  <span class="tag">&lt;<span class="name">Variable</span> <span class="attr">name</span>=<span class="string">"event_dtend1"</span> <span class="attr">type</span>=<span class="string">"long"</span> <span class="attr">column</span>=<span class="string">"dtend"</span> <span class="attr">row</span>=<span class="string">"0"</span>/&gt;</span>结束</span><br><span class="line">  <span class="tag">&lt;<span class="name">Variable</span> <span class="attr">name</span>=<span class="string">"event_allDay1"</span> <span class="attr">type</span>=<span class="string">"int"</span> <span class="attr">column</span>=<span class="string">"allDay"</span> <span class="attr">row</span>=<span class="string">"0"</span>/&gt;</span>一整天</span><br><span class="line">  <span class="tag">&lt;<span class="name">Variable</span> <span class="attr">name</span>=<span class="string">"event_lastDate1"</span> <span class="attr">type</span>=<span class="string">"long"</span> <span class="attr">column</span>=<span class="string">"lastDate"</span> <span class="attr">row</span>=<span class="string">"0"</span>/&gt;</span>最后日期</span><br><span class="line">  <span class="tag">&lt;<span class="name">Variable</span> <span class="attr">name</span>=<span class="string">"cal_title2"</span> <span class="attr">type</span>=<span class="string">"string"</span> <span class="attr">column</span>=<span class="string">"title"</span> <span class="attr">row</span>=<span class="string">"1"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">Variable</span> <span class="attr">name</span>=<span class="string">"event_start2"</span> <span class="attr">type</span>=<span class="string">"long"</span> <span class="attr">column</span>=<span class="string">"dtstart"</span> <span class="attr">row</span>=<span class="string">"1"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">Variable</span> <span class="attr">name</span>=<span class="string">"event_end2"</span> <span class="attr">type</span>=<span class="string">"long"</span> <span class="attr">column</span>=<span class="string">"dtend"</span> <span class="attr">row</span>=<span class="string">"1"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">Variable</span> <span class="attr">name</span>=<span class="string">"event_location2"</span> <span class="attr">type</span>=<span class="string">"string"</span> <span class="attr">column</span>=<span class="string">"eventLocation"</span> <span class="attr">row</span>=<span class="string">"1"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">Variable</span> <span class="attr">name</span>=<span class="string">"cal_title3"</span> <span class="attr">type</span>=<span class="string">"string"</span> <span class="attr">column</span>=<span class="string">"title"</span> <span class="attr">row</span>=<span class="string">"2"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">Variable</span> <span class="attr">name</span>=<span class="string">"event_start3"</span> <span class="attr">type</span>=<span class="string">"long"</span> <span class="attr">column</span>=<span class="string">"dtstart"</span> <span class="attr">row</span>=<span class="string">"2"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">Variable</span> <span class="attr">name</span>=<span class="string">"event_end3"</span> <span class="attr">type</span>=<span class="string">"long"</span> <span class="attr">column</span>=<span class="string">"dtend"</span> <span class="attr">row</span>=<span class="string">"2"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">Variable</span> <span class="attr">name</span>=<span class="string">"event_location3"</span> <span class="attr">type</span>=<span class="string">"string"</span> <span class="attr">column</span>=<span class="string">"eventLocation"</span> <span class="attr">row</span>=<span class="string">"2"</span>/&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">ContentProviderBinder</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">VariableBinders</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;待办事项接口&quot;&gt;&lt;a href=&quot;#待办事项接口&quot; class=&quot;headerlink&quot; title=&quot;待办事项接口&quot;&gt;&lt;/a&gt;待办事项接口&lt;/h2&gt;
    
    </summary>
    
      <category term="tutorials" scheme="http://dzzzw.github.io/dzane/categories/tutorials/"/>
    
    
      <category term="MAML 本地接口" scheme="http://dzzzw.github.io/dzane/tags/MAML-%E6%9C%AC%E5%9C%B0%E6%8E%A5%E5%8F%A3/"/>
    
  </entry>
  
  <entry>
    <title>计步接口</title>
    <link href="http://dzzzw.github.io/dzane/step/"/>
    <id>http://dzzzw.github.io/dzane/step/</id>
    <published>2019-01-10T16:34:14.000Z</published>
    <updated>2019-01-13T07:11:07.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="数据来源小米计步"><a href="#数据来源小米计步" class="headerlink" title="数据来源小米计步"></a>数据来源小米计步</h2><a id="more"></a><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">VariableBinders</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">ContentProviderBinder</span> <span class="attr">name</span>=<span class="string">"MiStep"</span> <span class="attr">uri</span>=<span class="string">"content://com.miui.providers.steps/item"</span> <span class="attr">columns</span>=<span class="string">"_id,_begin_time,_end_time,_mode,_steps"</span> <span class="attr">countName</span>=<span class="string">"hassteps"</span> <span class="attr">whereFormat</span>=<span class="string">"_begin_time&gt;='%d'"</span> <span class="attr">whereParas</span>=<span class="string">"#today_begin_time"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">Variable</span> <span class="attr">name</span>=<span class="string">"Mi_step"</span> <span class="attr">type</span>=<span class="string">"string[]"</span> <span class="attr">column</span>=<span class="string">"_steps"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">Variable</span> <span class="attr">name</span>=<span class="string">"Mi_begin_time"</span> <span class="attr">type</span>=<span class="string">"string[]"</span> <span class="attr">column</span>=<span class="string">"_begin_time"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">Variable</span> <span class="attr">name</span>=<span class="string">"Mi_end_time"</span> <span class="attr">type</span>=<span class="string">"string[]"</span> <span class="attr">column</span>=<span class="string">"_end_time"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">Trigger</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!-- 复位今天的总步数 --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">VariableCommand</span> <span class="attr">name</span>=<span class="string">"step_today"</span> <span class="attr">expression</span>=<span class="string">"0"</span> /&gt;</span></span><br><span class="line">   <span class="comment">&lt;!-- 计算今天0时0点时间戳 --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">VariableCommand</span> <span class="attr">name</span>=<span class="string">"today_begin_time"</span> <span class="attr">expression</span>=<span class="string">"int((#time_sys-#hour24*3600000-#minute*60000-#second*1000)/1000)*1000"</span> /&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">BinderCommand</span> <span class="attr">name</span>=<span class="string">"MiStep"</span> <span class="attr">command</span>=<span class="string">"refresh"</span> <span class="attr">condition</span>=<span class="string">"#step_reflash==0"</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">LoopCommand</span> <span class="attr">count</span>=<span class="string">"#hassteps"</span> <span class="attr">indexName</span>=<span class="string">"__s"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 今天的总步数 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">VariableCommand</span> <span class="attr">name</span>=<span class="string">"step_today"</span> <span class="attr">expression</span>=<span class="string">"#step_today+int(@Mi_step[#__s])"</span> /&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">LoopCommand</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">VariableCommand</span> <span class="attr">name</span>=<span class="string">"step_reflash"</span> <span class="attr">expression</span>=<span class="string">"1"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">Trigger</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">ContentProviderBinder</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">VariableBinders</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Text</span> <span class="attr">x</span>=<span class="string">"100"</span> <span class="attr">y</span>=<span class="string">"100"</span> <span class="attr">color</span>=<span class="string">"#ffffff"</span> <span class="attr">size</span>=<span class="string">"40"</span> <span class="attr">textExp</span>=<span class="string">"#step_today"</span>/&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;数据来源小米计步&quot;&gt;&lt;a href=&quot;#数据来源小米计步&quot; class=&quot;headerlink&quot; title=&quot;数据来源小米计步&quot;&gt;&lt;/a&gt;数据来源小米计步&lt;/h2&gt;
    
    </summary>
    
      <category term="tutorials" scheme="http://dzzzw.github.io/dzane/categories/tutorials/"/>
    
    
      <category term="MAML 本地接口" scheme="http://dzzzw.github.io/dzane/tags/MAML-%E6%9C%AC%E5%9C%B0%E6%8E%A5%E5%8F%A3/"/>
    
  </entry>
  
  <entry>
    <title>概述</title>
    <link href="http://dzzzw.github.io/dzane/about/"/>
    <id>http://dzzzw.github.io/dzane/about/</id>
    <published>2018-11-26T17:10:36.000Z</published>
    <updated>2019-01-13T07:11:38.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="MAML引擎脚本语言"><a href="#MAML引擎脚本语言" class="headerlink" title="MAML引擎脚本语言"></a>MAML引擎脚本语言</h3><a id="more"></a><p>   MIUI Application Markup Language for MORE （MIUI MORE引擎应用标记语言）<br><br></p><h3 id="MORE渲染引擎"><a href="#MORE渲染引擎" class="headerlink" title="MORE渲染引擎"></a>MORE渲染引擎</h3><p>   Markup Oriented Rendering Engine （基于标记语言的渲染引擎）</p><p><br></p><h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><p>最初用于百变锁屏，使用xml用特定的语法描述锁屏界面。后来不断增强功能，逐步演化成一套接近通用的界面描述语言和图形渲染引擎，在一定需求下可用于开发风格多变的用户界面。可方便地通过更换皮肤改变界面风格、动画甚至交互方式。<br>MAML语言和Android的界面描述xml 类似. 所不同的是Android描述的是静态界面，对界面元素的更改依赖java代码。MAML描述的是静态界面+动态属性，UI在时间线上按一定的帧率不断刷新，UI显示根据元素属性的变量表达式的计算结果实时更新。MAML语言和运行时引擎已经从锁屏中独立出来作为MIUI内置的通用框架，除了显示时间日期等，还支持查询标准Content Provider来获取各种信息如天气。显示图片文本等各种元素，各种动画，滑动点击等界面交互控件，适于实现展示信息或有简单交互操作的界面。比如时钟、天气小部件、闹钟响铃界面。<br>框架支持动态帧率，不必按照固定帧率不停渲染，在没有动画和更新的时侯停止渲染，此时仅占用极少资源，对于缓慢变化的动画使用低帧率渲染，高动态的动画开始后立即调整到高帧率全速渲染。全速渲染时全屏帧率基本可以达到60帧。合理使用可以既炫酷又不费电。<br><br></p><h3 id="MORE引擎适用哪些类型的界面开发"><a href="#MORE引擎适用哪些类型的界面开发" class="headerlink" title="MORE引擎适用哪些类型的界面开发"></a>MORE引擎适用哪些类型的界面开发</h3><ol><li>展示性的信息，如图片，文字 （不适合列表信息和大段文本，不适合用户输入）</li><li>需要有丰富的界面动画及交互动画。</li><li>较简单的交互，拖拽、点击 （但不限于拖拽点击，通过xml代码可以实现部分类似java编程中onTouchEvent所能做到的交互）</li><li>使用标准控件无法实现的信息展示方式，或者无法实现的交互方式，需要自制控件的，大部分可以通过xml代码方便地描述实现。</li><li>需要灵活更换皮肤风格，并且界面动画和交互动画甚至部分交互方式都可以通过皮肤更换。无需更改应用程序。</li><li>比如一些简单的工具类应用程序、无输入的操作界面希望能更换操作模式（例如来电接听界面）和桌面小工具可以考虑使用，也可以作为一个动画框架实现类似电子贺卡的界面，可支持交互，做为应用程序中的彩蛋（比如短信中的生日彩蛋）</li></ol><ul><li><strong>MIUI主题使用MORE的模块</strong></li></ul><table><thead><tr><th>名称</th><th>主题包对应模块</th></tr></thead><tbody><tr><td>百变锁屏</td><td>LockScreen</td></tr><tr><td>桌面时钟</td><td>clock_2x4</td></tr><tr><td>百变壁纸</td><td>MiWallpaper</td></tr><tr><td>动态图标</td><td>icon</td></tr><tr><td>自由桌面</td><td>clock_2x4</td></tr></tbody></table>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;MAML引擎脚本语言&quot;&gt;&lt;a href=&quot;#MAML引擎脚本语言&quot; class=&quot;headerlink&quot; title=&quot;MAML引擎脚本语言&quot;&gt;&lt;/a&gt;MAML引擎脚本语言&lt;/h3&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>入门教程</title>
    <link href="http://dzzzw.github.io/dzane/guide/"/>
    <id>http://dzzzw.github.io/dzane/guide/</id>
    <published>2018-11-26T17:10:36.000Z</published>
    <updated>2019-01-13T07:41:57.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="百变锁屏"><a href="#百变锁屏" class="headerlink" title="百变锁屏"></a>百变锁屏</h2><a id="more"></a><p>百变锁屏在主题包里的lockscreen/advance目录下，manifest.xml文件是描述脚本</p><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Lockscreen</span> <span class="attr">frameRate</span>=<span class="string">""</span> <span class="attr">displayDesktop</span>=<span class="string">""</span>  <span class="attr">showSysWallpaper</span>=<span class="string">""</span> <span class="attr">screenWidth</span>=<span class="string">"1080"</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">Image</span> /&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">Image</span> /&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">Unlocker</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">Unlocker</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">Time</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">DateTime</span>/&gt;</span></span><br><span class="line">    …</span><br><span class="line">   <span class="tag">&lt;<span class="name">Text</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Lockscreen</span>&gt;</span></span><br></pre></td></tr></table></figure><p>其中</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">frameRate           指定帧率，如果动画缓慢，可以指定小一点的值，省电。默认为30。  </span><br><span class="line">displayDesktop      默认为false，透视到桌面功能，如果没有锁屏壁纸或者锁屏壁纸可以被移开或透明时可以看到桌面launcher或者是锁屏前的应用程序。可以完美实现WP7，Meego，阿里云等的解锁界面。   </span><br><span class="line">showSysWallpaper    默认为false,是否在锁屏界面显示桌面壁纸。开启后如果没有指定锁屏壁纸&lt;Wallpaper/&gt;,会将桌面壁纸作为锁屏的壁纸。  </span><br><span class="line">screenWidth         设定屏幕宽度标准。如果指定为1080,锁屏中所有元素的位置都按1080p的布局编写，720p、480p等分辨率的手机会自动进行缩放。</span><br></pre></td></tr></table></figure><p><br></p><h2 id="百变壁纸"><a href="#百变壁纸" class="headerlink" title="百变壁纸"></a>百变壁纸</h2><p>百变壁纸在主题包的miwallpaper目录下，描述文件也是manifest.xml。根节点表示与百变锁屏基本一致：  </p><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">MiWallpaper</span> <span class="attr">frameRate</span>=<span class="string">"1"</span> <span class="attr">width</span>=<span class="string">"1080"</span> <span class="attr">height</span>=<span class="string">"1920"</span> <span class="attr">screenWidth</span>=<span class="string">"1080"</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">Var</span>/&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">Image</span>/&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">Group</span>/&gt;</span></span><br><span class="line">      …</span><br><span class="line"><span class="tag">&lt;/<span class="name">MiWallpaper</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">width表示百变壁纸的宽度。</span><br><span class="line">height表示高度</span><br><span class="line">wallpaper_offset_pixel_x偏移的像素数 （0 ～ -1*屏宽）</span><br><span class="line">wallpaper_offset_x偏移百分比 （0 ~ 1.0）</span><br></pre></td></tr></table></figure><p>要实现元素跟随手指滑动的效果，需要借助#wallpaper_offset_pixel_x，#wallpaper_offset_x 二者关系：#wallpaper_offset_x <em> 屏宽 = -1</em>#wallpaper_offset_pixel_x<br>滑动时： 在第一屏，wallpaper_offset_pixel_x = 0, wallpaper_offset_x = 0; 滑到最后一屏，wallpaper_offset_pixel_x = -1*屏宽，wallpaper_offset_x = 1.0  </p><blockquote><p>为了适配不同分辨率机型，建议使用#wallpaper_offset_x。建议的设计方式：<br>壁纸切成双屏宽 （屏宽指的是screenWidth）<br>壁纸定位：x=”-#wallpaper_offset_x <em> 屏宽”<br>需要跟随滑动的元素定位：x=”-#wallpaper_offset_x </em> 屏宽 + 相对壁纸的位置”    </p></blockquote><p><br></p><h2 id="动态图标"><a href="#动态图标" class="headerlink" title="动态图标"></a>动态图标</h2><p>动态图标在主题包icons\fancy_icons\目录下，每个动态图标是一个文件夹，文件夹的名字是对应的app包名。例如日历的动态图标是一个叫”com.android.calendar”的文件夹，里面包含manifest.xml描述文件  </p><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Icon</span> <span class="attr">version</span>=<span class="string">"1"</span> <span class="attr">frameRate</span>=<span class="string">""</span> <span class="attr">width</span>=<span class="string">"136"</span> <span class="attr">height</span>=<span class="string">"136"</span> <span class="attr">screenWidth</span>=<span class="string">"720"</span> <span class="attr">useVariableUpdater</span>=<span class="string">""</span> <span class="attr">hideApplicationMessage</span>=<span class="string">""</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Var</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Image</span>/&gt;</span>   </span><br><span class="line">    <span class="tag">&lt;<span class="name">Text</span>/&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">DateTime</span>/&gt;</span></span><br><span class="line">     …  </span><br><span class="line"><span class="tag">&lt;/<span class="name">Icon</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li><p><strong>hideApplicationMessage</strong>: 默认false,屏蔽右上角的通知标志。  </p></li><li><p><strong>useVariableUpdater</strong>： 指定需要哪些系统变量，目前包括电量和时间，而且可以指定时间的更新周期，如果时间小工具每秒更新一次，需要指定更新周期为1秒，否则默认会每分钟更新一次。如果小工具或动态图标只显示日期，则每天更新一次，可以指定更新周期为1天。尽量选择较长的更新周期，以节约系统资源。<br>目前支持的tag： Battery, DateTime.Day, DateTime.Hour,DateTime.Minute,DateTime.Second  </p><blockquote><p>如果某个小工具不需要电量或时间变量，则需要使用useVariableUpdater=”none”，指定不做时间变量等更新。<br>如果某个小工具显示系统电量并且显示根据时间每小时更换背景图片: useVariableUpdater=”Battery,DateTime.Hour”<br>如果需要每秒进行多次刷新，可以直接使用frameRate  </p></blockquote></li></ul><p><br></p><h2 id="机型适配"><a href="#机型适配" class="headerlink" title="机型适配"></a>机型适配</h2><p>一份manifest文件，可以同时运行在多个设备，只需要设置好在不同尺寸或密度的设备上使用的资源和缩放比例就可以了。<br>1.资源适配：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">extraResources=&quot;sw1000-den320:den320:1.2,sw1000-den320::1.2,sw1000-den320-large:den320:1.2&quot;</span><br></pre></td></tr></table></figure><p> <strong>sw1000-den320:den320:1.2</strong>&#160;&#160;&#160;&#160;&#160;在屏宽是1000密度是320的机型上，使用的是den320文件夹下的资源，并且放大1.2倍；<br> <strong>sw1000-den320::1.2</strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;在屏宽1000密度320的机型上，使用的是默认的资源，并且放大1.2倍)</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">extraResources=&quot;sw2000-den480:1.8,sw1000-den320-large:1.8&quot;</span><br></pre></td></tr></table></figure><p>这两句话中间都是只有一个冒号，意思是sw2000-den480的机型使用的资源就是在sw2000-den480这一同名文件夹下的资源，并且放大1.8倍)</p><p><br></p><p>2.布局适配：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">extraScales=&quot;sw1000-den320:1.2,sw2000-den480-large:1.8&quot;</span><br></pre></td></tr></table></figure><p><strong>适配原理</strong>：  </p><ol><li>首先把你所有自定义中出现的den和sw做一个列表 （比如这里extraResources=”sw1440-den440::0.916, sw720-den320::0.667, sw480-den240::0.444”，涉及到的den有440, 320, 240, 再加上一个默认的480; sw有1440, 720, 480, 再加一个默认的1080(与den480对应) )  </li><li>然后当你的主题放到一个设备上时，首先拿你的设备密度去上面的den列表中找，找到最贴近的一个，然后如果同样den有多个sw，那么再拿设备的屏宽去这几个sw中找最贴近的一个，这样就找到了最合适的swXXX-denXXX  </li><li>最后，资源就取这个sw-den对应的目录下的资源，及缩放比例Sr。代码中数字的缩放比例就使用sw-den对应的Ss.</li><li>最最后，就是缩放比例 </li></ol><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">如果按密度缩放（即scaleByDensity=&quot;true&quot;）：   资源真正的缩放比例是Sr * 设备den / 找到的den，代码中的数字缩放比例是Ss * 设备den / 找到的den</span><br><span class="line"></span><br><span class="line">如果按屏宽缩放（即scaleByDensity=&quot;false&quot;）：  资源真正的缩放比例是Sr * 设备sw / 找到的sw  ，代码中的数字缩放比例是Ss * 设备sw / 找到的sw</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;百变锁屏&quot;&gt;&lt;a href=&quot;#百变锁屏&quot; class=&quot;headerlink&quot; title=&quot;百变锁屏&quot;&gt;&lt;/a&gt;百变锁屏&lt;/h2&gt;
    
    </summary>
    
    
  </entry>
  
</feed>
